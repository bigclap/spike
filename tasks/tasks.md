*   **Задача 1.3: Реализация проверки авторизации на hh.ru**
    *   (Без изменений) При запуске открыть `https://hh.ru/applicant/resumes` и проверить наличие элементов, подтверждающих авторизацию.

---

#### **Эпик 2: Сбор и обработка данных с hh.ru**

Цель: Научить расширение собирать всю необходимую текстовую информацию.

*   **Задача 2.1: Парсинг страницы "Мои резюме"**
    *   (Без изменений) Найти все резюме и извлечь для каждого ссылку на поиск вакансий и **ссылку на само резюме** для последующего парсинга текста.

*   **Задача 2.2: Парсинг текста резюме**
    *   **Новая задача:** Для каждого резюме открыть его страницу на hh.ru.
    *   Написать content script, который "прочитает" и соберет в единую текстовую переменную всю информацию: опыт работы, ключевые навыки, образование, обо мне и т.д.
    *   Эту текстовую переменную фоновый скрипт будет хранить для дальнейшей отправки в нейросеть.

*   **Задача 2.3: Навигация по страницам с вакансиями и сбор данных**
    *   (Без изменений) Переходить по страницам со списками вакансий, открывать каждую по очереди и парсить с них описание.

---

#### **Эпик 3: Интеграция с локальной нейросетью**

Цель: Наладить общение с локальной моделью для оценки вакансий и генерации писем.

*   **Задача 3.1: Формирование промптов**
    *   Определить точные текстовые шаблоны для запросов к модели.
        *   **Промпт для оценки:** `Системная инструкция: Ты — HR-ассистент. Оцени соответствие резюме вакансии по шкале от 1 до 5. В ответе укажи только одну цифру без пояснений. \n\n### Резюме:\n{текст_резюме}\n\n### Вакансия:\n{текст_вакансии}\n\n### Оценка:`
        *   **Промпт для письма:** `Системная инструкция: Ты — HR-ассистент. Напиши профессиональное и вежливое сопроводительное письмо на основе резюме для указанной вакансии. \n\n### Резюме:\n{текст_резюме}\n\n### Вакансия:\n{текст_вакансии}\n\n### Сопроводительное письмо:`

*   **Задача 3.2: Реализация API-клиента в фоновом скрипте**
    *   Написать в `background.js` асинхронную функцию, которая будет отправлять `fetch`-запросы к локальному API (URL берется из настроек).
    *   Функция должна принимать текст промпта и возвращать ответ от модели.
    *   Реализовать обработку ошибок: что делать, если сервер недоступен или вернул ошибку.

*   **Задача 3.3: Реализация логики "оценка -> письмо"**
    *   Создать в `background.js` управляющую функцию, которая:
        1.  Вызывает API-клиент с промптом для оценки.
        2.  Получает ответ, парсит из него цифру.
        3.  Если оценка >= 4, вызывает API-клиент повторно, но уже с промптом для генерации сопроводительного письма.
        4.  Возвращает сгенерированное письмо или сигнал о пропуске вакансии.

---

#### **Эпик 4: Автоматический отклик на вакансию**

(Без изменений, так как эта часть не зависит от источника сопроводительного письма)

*   **Задача 4.1: Инициация отклика**
*   **Задача 4.2: Вставка сопроводительного письма**
*   **Задача 4.3: Отправка отклика**

---

#### **Эпик 5: Хранение данных и улучшения**

(Без изменений, логика та же)

*   **Задача 5.1: Настройка локальной базы данных (IndexedDB)**
*   **Задача 5.2: Интеграция с БД для пропуска обработанных вакансий**
*   **Задача 5.3: Визуализация оценок на странице поиска**
*   **Задача 5.4: Реализация задержек и обработка ошибок**
*   **Задача 5.5 (Продвинутая): Обработка вакансий с доп. вопросами**

Этот обновленный план стал более реалистичным и технически грамотным. Самая сложная и непредсказуемая часть (автоматизация чужого UI) заменена на стандартную и надежную работу с API.
